WITH CTE AS
(SELECT *, SUM(weight) OVER(ORDER BY turn ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS Total_Weight
FROM Queue)

SELECT person_name 
FROM CTE WHERE Total_weight <=1000
ORDER BY Total_weight DESC LIMIT 1;
